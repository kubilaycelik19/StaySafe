<script>
    function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('tr-TR');
        document.getElementById('current-time').textContent = timeString;
    }
    
    // Her saniye saati güncelle
    setInterval(updateTime, 1000);
    updateTime();

    // Kamera açma/kapama kontrolü
    const toggleButton = document.getElementById('toggleCamera');
    const videoFeed = document.getElementById('videoFeed');
    const cameraOffMessage = document.getElementById('cameraOffMessage');
    const statusBadge = document.getElementById('statusBadge');
    const cameraStatus = document.getElementById('cameraStatus');
    let isCameraOn = true;

    toggleButton.addEventListener('click', function() {
        fetch('/display/toggle_camera')
            .then(response => response.json())
            .then(data => {
                isCameraOn = data.camera_is_active;
                updateCameraUI();
                
                // Video feed'i yenile
                if (isCameraOn) {
                    videoFeed.src = "{% url 'video_feed' %}?" + new Date().getTime();
                } else {
                    videoFeed.src = "";
                }
            });
    });

    function updateCameraUI() {
        if (isCameraOn) {
            toggleButton.innerHTML = '<i class="fas fa-power-off me-2"></i>Kamerayı Kapat';
            toggleButton.classList.remove('btn-success');
            toggleButton.classList.add('btn-warning');
            statusBadge.classList.remove('bg-danger');
            statusBadge.classList.add('bg-success');
            statusBadge.innerHTML = '<i class="fas fa-circle me-1"></i>Canlı Yayın';
            cameraStatus.textContent = 'Aktif';
            cameraStatus.classList.remove('text-danger');
            cameraStatus.classList.add('text-success');
            cameraOffMessage.style.display = 'none';
            videoFeed.style.display = 'block';
        } else {
            toggleButton.innerHTML = '<i class="fas fa-power-off me-2"></i>Kamerayı Aç';
            toggleButton.classList.remove('btn-warning');
            toggleButton.classList.add('btn-success');
            statusBadge.classList.remove('bg-success');
            statusBadge.classList.add('bg-danger');
            statusBadge.innerHTML = '<i class="fas fa-circle me-1"></i>Kapalı';
            cameraStatus.textContent = 'Kapalı';
            cameraStatus.classList.remove('text-success');
            cameraStatus.classList.add('text-danger');
            cameraOffMessage.style.display = 'block';
            videoFeed.style.display = 'none';
        }
    }
</script> 